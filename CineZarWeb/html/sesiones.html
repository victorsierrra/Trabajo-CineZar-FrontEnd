<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sesiones de Película</title>
    <link rel="stylesheet" href="/build/sesiones.css">
</head>
<body>
    <div class="container">
        <header>
            <h1 id="titulo-pelicula">Sesiones de la película</h1>
            <img id="movie-poster" src="" alt="Poster de la película">
        </header>

        <section class="session-controls">
            <button onclick="cambiarDia(-1)">◀️</button>
            <span id="dia-seleccionado">Lunes</span>
            <button onclick="cambiarDia(1)">▶️</button>
        </section>

        <section class="sessions" id="session-cards">
            <!-- Aquí se cargarán las tarjetas de horarios -->
        </section>

        <button class="back-button" onclick="window.history.back()">Volver</button>
    </div>

    <script>
        let aux = localStorage.getItem("selectedMovie");
        let peliculaSeleccionada = JSON.parse(aux)
        console.log('clog-----', aux)
        console.log('clog-----', peliculaSeleccionada)
        const peliculas = {
            "Cars": {
                titulo: "Cars",
                imagen: "images/cars-poster.jpg",
                sesiones: {
                    "Lunes": ["10:00 AM", "1:30 PM", "4:00 PM", "7:00 PM"],
                    "Martes": ["10:30 AM", "2:00 PM", "5:00 PM", "8:00 PM"]
                }
            },
            "Torrente, El brazo tonto de la ley": {
                titulo: "Torrente, El brazo tonto de la ley",
                imagen: "images/torrente-poster.jpg",
                sesiones: {
                    "Lunes": ["11:00 AM", "2:30 PM", "6:00 PM"],
                    "Martes": ["12:00 PM", "3:30 PM", "7:30 PM"]
                }
            }
        };

        let dias = ["Lunes", "Martes", "Miércoles", "Jueves", "Viernes", "Sábado", "Domingo"];
        let diaActual = 0;

        function cargarPelicula() {
        console.log('clog----- cargarPelicula', peliculaSeleccionada.titulo)
        
        // Recuperamos el título de la película desde localStorage
        const pelicula = peliculas[peliculaSeleccionada.titulo];
        console.log('clog----- pelicula', pelicula)
        console.log('clog----- peliculas', peliculas)
            
            if (pelicula) {
                document.getElementById("titulo-pelicula").textContent = pelicula.titulo;
                document.getElementById("movie-poster").src = pelicula.imagen;
                cargarSesiones(dias[diaActual]);
            } else {
                document.getElementById("titulo-pelicula").textContent = "Película no encontrada";
                document.getElementById("session-cards").innerHTML = "<p>No hay sesiones disponibles.</p>";
            }
        }

        function cargarSesiones(dia) {
            const peliculaSeleccionada = localStorage.getItem("peliculaSeleccionada");
            const pelicula = peliculas[peliculaSeleccionada];
            const horarios = pelicula.sesiones[dia] || [];

            document.getElementById("dia-seleccionado").textContent = dia;
            const sessionCards = document.getElementById("session-cards");
            sessionCards.innerHTML = "";

            horarios.forEach(horario => {
                const card = document.createElement("div");
                card.className = "session-card";
                card.textContent = horario;
                sessionCards.appendChild(card);
            });
        }

        function cambiarDia(direccion) {
            diaActual = (diaActual + direccion + dias.length) % dias.length;
            cargarSesiones(dias[diaActual]);
        }

        window.onload = cargarPelicula;
    </script>
</body>
</html>
